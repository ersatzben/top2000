<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Market Cap Bubble Chart: UK, USA, EU, Rest of World</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 20px; 
      background: #f9f9f9; 
    }
    svg { 
      display: block; 
      margin: 0 auto; 
      background: #f9f9f9; 
    }
    .tooltip {
      position: absolute; 
      background: white; 
      border: 1px solid #ddd; 
      border-radius: 4px;
      padding: 8px; 
      pointer-events: none; 
      font-size: 12px; 
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      z-index: 10;
    }
    h1 { 
      text-align: center; 
      margin: 20px 0 5px; 
      font-size: 28px; 
    }
    .subtitle { 
      text-align: center; 
      color: #666; 
      margin-bottom: 20px; 
      font-size: 16px; 
    }
    .region-label {
      font-size: 24px;
      font-weight: bold;
      text-anchor: middle;
      dominant-baseline: middle;
      pointer-events: none;
    }
    .region-background {
      fill: none;
      stroke: #ddd;
      stroke-width: 1px;
      stroke-dasharray: 5,5;
      rx: 10;
      ry: 10;
    }
    
    pre {
  background: #f0f0f0;
  padding: 12px;
  overflow-x: auto;
  border: 1px solid #ccc;
  font-size: 13px;
  white-space: pre-wrap;
  word-break: break-word;
}

button {
  margin-top: 10px;
  padding: 6px 12px;
  font-size: 14px;
  cursor: pointer;
}

  </style>
</head>
<body>
  <h1>Market Capitalization: UK, USA, EU, Rest of World</h1>
  <div class="subtitle">Bubble size represents market capitalisation. Darker bubbles = top 50</div>
  <div id="chart"></div>

  <script>
    function processCSVData(csvContent) {
      const EU_COUNTRIES = new Set(["France","Germany","Netherlands","Sweden","Spain","Italy","Belgium","Denmark","Ireland","Austria","Finland","Portugal","Poland","Luxembourg","Greece","Czech Republic","Hungary","Romania","Slovakia","Slovenia","Estonia","Latvia","Lithuania","Croatia","Bulgaria"]);
      return csvContent.split('\n').slice(1).map(row => {
        const [rank, name, symbol, marketcap, price, country] = row.split(',').map(d => d.replace(/^"|"$/g, ''));
        const capValue = parseFloat(marketcap) / 1e9;
        if (!name || !symbol || isNaN(capValue)) return null;
        let region;
        if (country === "United Kingdom") region = "UK";
        else if (country === "United States") region = "USA";
        else if (EU_COUNTRIES.has(country)) region = "EU";
        else region = "RoW";
        return { name, ticker: symbol, marketCap: capValue, country, region };
      }).filter(d => d !== null).sort((a, b) => b.marketCap - a.marketCap);
    }
    
    const csvContent = `"Rank","Name","Symbol","marketcap","price (USD)","country"
"1","Microsoft","MSFT","3338251272192","449.14","United States"
"2","Apple","AAPL","3180279627776","212.93","United States"
"3","NVIDIA","NVDA","3170291679232","129.93","United States"
"4","Amazon","AMZN","2243988291584","211.37","United States"
"5","Alphabet (Google)","GOOG","1943277666304","160.89","United States"
"6","Saudi Aramco","2222.SR","1683041503060","6.95889","Saudi Arabia"
"7","Meta Platforms (Facebook)","META","1649476108288","656.03","United States"
"8","Berkshire Hathaway","BRK-B","1103853912064","511.88","United States"
"9","Broadcom","AVGO","1092827217920","232.42","United States"
"10","Tesla","TSLA","1076026146816","334.07","United States"
"11","TSMC","TSM","1006138818560","193.99","Taiwan"
"12","Walmart","WMT","767125291008","95.88","United States"
"13","JPMorgan Chase","JPM","730928447488","263.01","United States"
"14","Visa","V","679789395968","356.14","United States"
"15","Eli Lilly","LLY","669764943872","746.06","United States"
"16","Tencent","TCEHY","597463072768","65.61","China"
"17","Mastercard","MA","523591024640","576.59","United States"
"18","Netflix","NFLX","484487036928","1138.44","United States"
"19","Exxon Mobil","XOM","471733207040","109.46","United States"
"20","Oracle","ORCL","455042400256","162.27","United States"
"21","Costco","COST","443252637696","999.03","United States"
"22","Procter & Gamble","PG","372148797440","158.73","United States"
"23","Home Depot","HD","371331497984","373.6","United States"
"24","Johnson & Johnson","JNJ","357157044224","148.44","United States"
"25","SAP","SAP","343857364992","289.73","Germany"
"26","ICBC","1398.HK","335762057901","0.721651","China"
"27","Bank of America","BAC","333511622656","44.28","United States"
"28","AbbVie","ABBV","332083200000","188","United States"
"29","Alibaba","BABA","314035273728","131.65","China"
"30","Hermès","RMS.PA","305864161801","2917.6","France"
"31","Palantir","PLTR","302304460800","128.1","United States"
"32","ASML","ASML","300365479936","763.9","Netherlands"
"33","Coca-Cola","KO","296822439936","68.96","United States"
"34","LVMH","MC.PA","294370501792","591.513","France"
"35","Novo Nordisk","NVO","289829257216","65.4","Denmark"
"36","Kweichow Moutai","600519.SS","285212795770","227.044","China"
"37","UnitedHealth","UNH","282465239040","311.38","United States"
"38","Salesforce","CRM","277451112448","289.17","United States"
"39","Samsung","005930.KS","271391861791","41.1596","South Korea"
"40","Agricultural Bank of China","601288.SS","269763238003","0.783203","China"
"41","T-Mobile US","TMUS","269487702016","237.34","United States"
"42","Nestlé","NESN.SW","262673559232","102.1","Switzerland"
"43","Philip Morris International","PM","254989107200","163.82","United States"
"44","Toyota","TM","252795289600","193.97","Japan"
"45","Roche","ROG.SW","248281673210","309.836","Switzerland"
"46","Wells Fargo","WFC","247285137408","75.99","United States"
"47","Chevron","CVX","246582951936","142.35","United States"
"48","Cisco","CSCO","245778743296","61.78","United States"
"49","IBM","IBM","240332767232","258.59","United States"
"50","International Holding Company","IHC.AE","239496152443","109.18","United Arab Emirates"
"51","China Mobile","0941.HK","239068385924","10.8953","China"
"52","General Electric","GE","236290703360","221.58","United States"
"53","Prosus","PRX.AS","232859543322","53.2924","Netherlands"
"54","L'Oréal","OR.PA","232044910077","424.302","France"
"55","Reliance Industries","RELIANCE.NS","226182132393","16.714","India"
"56","Abbott Laboratories","ABT","224526352384","129.05","United States"
"57","China Construction Bank","601939.SS","220783841982","1.28451","China"
"58","McDonald","MCD","220735569920","308.69","United States"
"59","Bank of China","601988.SS","215721993214","0.788757","China"
"60","ServiceNow","NOW","214579265536","1036.72","United States"
"61","Linde","LIN","212141195264","450.67","United Kingdom"
"62","American Express","AXP","211788038144","302.3","United States"
"63","AstraZeneca","AZN","211578273792","67.72","United Kingdom"
"64","Novartis","NVS","210998870016","106.83","Switzerland"
"65","Morgan Stanley","MS","207518793728","129.35","United States"
"66","HSBC","HSBC","206574927872","58.34","United Kingdom"
"67","PetroChina","0857.HK","204755144060","0.812659","China"
"68","Intuitive Surgical","ISRG","202129833984","563.95","United States"
"69","Accenture","ACN","201912156160","322.53","Ireland"
"70","Shell","SHEL","200709079040","67.61","United Kingdom"
"71","Walt Disney","DIS","200233385984","111.38","United States"
"72","Siemens","SIE.DE","197567470941","252.251","Germany"
"73","Merck","MRK","192420216832","76.63","United States"
"74","Uber","UBER","191802114048","91.72","United States"
"75","AT&T","T","190323621888","26.45","United States"
"76","Goldman Sachs","GS","185273663488","603.81","United States"
"77","HDFC Bank","HDB","184729141248","72.39","India"
"78","Intuit","INTU","183616307200","656.8","United States"
"79","AMD","AMD","182342647808","112.46","United States"
"80","Commonwealth Bank","CBA.AX","181548276506","108.582","Australia"
"81","Blackstone Group","BX","180285980672","148.6","United States"
"82","Verizon","VZ","179823067136","42.65","United States"
"83","Pepsico","PEP","178665422848","130.31","United States"
"84","Fomento Económico Mexicano","FMX","176994500608","102.03","Mexico"
"85","Deutsche Telekom","DTE.DE","175850630167","35.8847","Germany"
"86","RTX","RTX","174635384832","130.72","United States"
"87","Royal Bank Of Canada","RY","172046172160","121.8","Canada"
"88","Booking Holdings (Booking.com)","BKNG","171240718336","5262.42","United States"
"89","Texas Instruments","TXN","170974429184","188.2","United States"
"90","PDD Holdings (Pinduoduo)","PDD","169577201664","119.45","China"
"91","Adobe","ADBE","169371877376","397.4","United States"
"92","Inditex","IDEXY","168694595584","27.08","Spain"
"93","QUALCOMM","QCOM","166171312128","151.34","United States"
"94","Caterpillar","CAT","165804851200","352.54","United States"
"95","Progressive","PGR","165661032448","282.59","United States"
"96","Thermo Fisher Scientific","TMO","161926070272","428.95","United States"
"97","Xiaomi","XIACF","161819017216","6.37","China"
"98","CATL","300750.SZ","160575030917","36.4661","China"
"99","CM Bank","3968.HK","158806096302","6.31926","China"
"100","S&P Global","SPGI","158116560896","515.57","United States"
"101","BYD","002594.SZ","157366522611","51.8108","China"
"102","Charles Schwab","SCHW","156659154944","86.22","United States"
"103","Boeing","BA","153379897344","203.42","United States"
"104","Boston Scientific","BSX","152309366784","102.95","United States"
"105","Allianz SE","ALV.DE","152212984854","394.417","Germany"
"106","Unilever","UL","151512383488","60.77","United Kingdom"
"107","Tata Consultancy Services","TCS.NS","150659633949","41.6407","India"
"108","Mitsubishi UFJ Financial","MUFG","149814624256","13.02","Japan"
"109","BlackRock","BLK","148601913344","959.18","United States"
"110","Nextera Energy","NEE","148447805440","72.11","United States"
"111","Sony","SONY","148293255168","24.54","Japan"
"112","Stryker Corporation","SYK","148100399104","387.53","United States"
"113","TJX Companies","TJX","146059231232","130.82","United States"
"114","Amgen","AMGN","145422581760","270.45","United States"
"115","Airbus","AIR.PA","141779655867","180.077","Netherlands"
"116","Citigroup","C","141144358912","75.57","United States"
"117","Danaher","DHR","140707889152","196.61","United States"
"118","Applied Materials","AMAT","140576669696","173.03","United States"
"119","Honeywell","HON","140371542016","218.22","United States"
"120","Shopify","SHOP","139345461248","107.68","Canada"
"121","Schneider Electric","SU.PA","139098389554","248.143","France"
"122","Union Pacific Corporation","UNP","136373886976","228.25","United States"
"123","Deere &amp; Company (John Deere)","DE","135318888448","498.57","United States"
"124","Arm Holdings","ARM","133520719872","126.68","United Kingdom"
"125","TotalEnergies","TTE","132362829824","59.9","France"
"126","China Life Insurance","601628.SS","130937109344","5.55046","China"
"127","Anheuser-Busch Inbev","BUD","130348892160","65.91","Belgium"
"128","Pfizer","PFE","130024415232","22.87","United States"
"129","Comcast","CMCSA","129895432192","34.79","United States"
"130","Eaton","ETN","129422475264","330.75","Ireland"
"131","Lowe's Companies","LOW","129163354112","230.77","United States"
"132","Bharti Airtel","BHARTIARTL.NS","128947988252","21.5226","India"
"133","Ping An Insurance","601318.SS","128871307371","7.58151","China"
"134","EssilorLuxottica","EL.PA","128810762719","283.206","France"
"135","BHP Group","BHP","128574705000","50.81","Australia"
"136","MercadoLibre","MELI","127510052864","2515.12","Argentina"
"137","Spotify","SPOT","127149072384","620.07","Sweden"
"138","Palo Alto Networks","PANW","127123193856","192","United States"
"139","Gilead Sciences","GILD","126280343552","101.43","United States"
"140","AppLovin","APP","125237035008","370.1","United States"
"141","Sanofi","SNY","125127819264","49.96","France"
"142","Automatic Data Processing","ADP","125101416448","308.19","United States"
"143","Arista Networks","ANET","122138222592","97.25","United States"
"144","Hitachi","6501.T","121491097064","26.5388","Japan"
"145","ICICI Bank","IBN","120034787328","33.52","India"
"146","Safran","SAF.PA","119135691670","283.769","France"
"147","Air Liquide","AI.PA","118930227753","204.93","France"
"148","ConocoPhillips","COP","118881148928","94.17","United States"
"149","GE Vernova","GEV","118270926848","433.33","United States"
"150","KKR & Co.","KKR","117409144832","126.9","United States"
"151","Strategy 
 (MicroStrategy)","MSTR","116628275200","421.61","United States"
"152","Chubb","CB","114339151872","285.33","Switzerland"
"153","Santander","SAN","112739254272","7.57","Spain"
"154","Analog Devices","ADI","112427835392","226.68","United States"
"155","Toronto Dominion Bank","TD","112010731520","63.94","Canada"
"156","CNOOC","0883.HK","111342132059","2.26109","China"
"157","Vertex Pharmaceuticals","VRTX","110936301568","432","United States"
"158","Marsh & McLennan Companies","MMC","110257750016","223.77","United States"
"159","Compagnie Financière Richemont","CFR.SW","109735031873","187.472","Switzerland"
"160","CrowdStrike","CRWD","109642375168","440.2","United States"
"161","Meituan","3690.HK","109168356815","17.8682","China"
"162","Medtronic","MDT","109156982784","85.11","Ireland"
"163","Lam Research","LRCX","109044981760","85.25","United States"
"164","Micron Technology","MU","108326068224","96.93","United States"
"165","Iberdrola","IBE.MC","107859778046","17.07","Spain"
"166","Lockheed Martin","LMT","107736326144","459.83","United States"
"167","Fiserv","FI","105896894464","191","United States"
"168","Keyence","6861.T","105731200065","435.96","Japan"
"169","KLA","KLAC","105250611200","795.9","United States"
"170","Al Rajhi Bank","1120.SR","104836561941","26.2091","Saudi Arabia"
"171","Amphenol","APH","103946485760","85.78","United States"
"172","China Shenhua Energy","601088.SS","103672642648","5.45465","China"
"173","ABB","ABBN.SW","103619817178","56.6554","Switzerland"
"174","UBS","UBS","103571308544","32.49","Switzerland"
"175","Fast Retailing","9983.T","102977054405","335.66","Japan"
"176","China Yangtze Power","600900.SS","102205663536","4.17708","China"
"177","SK Hynix","000660.KS","101974864707","147.716","South Korea"
"178","Prologis","PLD","101793480704","109.7","United States"
"179","Rio Tinto","RIO","101167579136","62.27","United Kingdom"
"180","BNP Paribas","BNP.PA","100850859973","89.2841","France"
"181","AXA","CS.PA","100408266979","45.6439","France"
"182","Intercontinental Exchange","ICE","99145515008","172.84","United States"
"183","Dior","CDI.PA","98978300081","548.627","France"
"184","Starbucks","SBUX","98730426368","86.88","United States"
"185","Intel","INTC","98406711296","22.56","United States"
"186","Intesa Sanpaolo","ISP.MI","98305290950","5.5296","Italy"
"187","Zurich Insurance Group","ZURN.SW","97826373170","687.538","Switzerland"
"188","UniCredit","UCG.MI","97819644773","62.7983","Italy"
"189","Enbridge","ENB","97164378112","44.57","Canada"
"190","DBS Group","D05.SI","97061851137","34.1327","Singapore"
"191","CME Group","CME","96698736640","268.34","United States"
"192","RELX","RELX","96364650496","52.4","United Kingdom"
"193","TAQA","TAQA.AE","96125122864","0.85","United Arab Emirates"
"194","American Tower","AMT","95481430016","203.96","United States"
"195","Altria Group","MO","95120900096","56.47","United States"
"196","Welltower","WELL","95006146560","145.28","United States"
"197","Bristol-Myers Squibb","BMY","94814371840","46.59","United States"
"198","Sumitomo Mitsui Financial Group","SMFG","94417567744","14.62","Japan"
"199","Southern Company","SO","94143250432","85.57","United States"
"200","Trane Technologies","TT","94084603904","421.87","Ireland"
"201","Brookfield Asset Management","BAM","94043332608","58.32","Canada"
"202","Nintendo","7974.T","93702836023","80.2128","Japan"
"203","China Telecom","0728.HK","93486456541","0.719088","China"
"204","Investor AB","INVE-B.ST","93044029348","30.366","Sweden"
"205","Nike","NKE","92087017472","62.39","United States"
"206","Brookfield Corporation","BN","91588911104","59.37","Canada"
"207","Sinopec","600028.SS","91517367337","0.809587","China"
"208","Constellation Energy","CEG","91367317504","291.52","United States"
"209","Sea Limited","SE","91248041984","154.13","Singapore"
"210","Recruit","6098.T","90942232596","62.0038","Japan"
"211","British American Tobacco","BTI","89888686080","40.69","United Kingdom"
"212","Waste Management","WM","89487491072","222.38","United States"
"213","Sherwin-Williams","SHW","89223979008","356.04","United States"
"214","Rolls-Royce Holdings","RR.L","88877513921","1062.51","United Kingdom"
"215","AIA","1299.HK","88751858453","8.37013","Hong Kong"
"216","HCA Healthcare","HCA","88555290624","368.1","United States"
"217","Enel","ENEL.MI","88195520144","8.68528","Italy"
"218","Duke Energy","DUK","87884447744","113.07","United States"
"219","Ferrari","RACE","87723696128","490.88","Italy"
"220","Moody's","MCO","87215947776","484.7","United States"
"221","Cadence Design Systems","CDNS","87007559680","318.66","United States"
"222","Cintas","CTAS","86947454976","215.33","United States"
"223","NTT (Nippon Telegraph &amp; Telephone)","9432.T","86843964073","1.04962","Japan"
"224","Parker-Hannifin","PH","86687145984","678.42","United States"
"225","McKesson","MCK","85972500480","687.78","United States"
"226","Interactive Brokers","IBKR","85695225856","202.78","United States"
"227","United Parcel Service","UPS","85527289856","99.81","United States"
"228","Airbnb","ABNB","85206253568","138.05","United States"
"229","Arthur J. Gallagher & Co.","AJG","85188837376","332.7","United States"
"230","Equinix","EQIX","84984168448","868.79","United States"
"231","Banco Bilbao Vizcaya Argentaria","BBVA","84967710720","14.76","Spain"
"232","Elevance Health","ELV","84816003072","375.4","United States"
"233","Chugai Pharmaceutical","4519.T","84614739029","51.4185","Japan"
"234","State Bank of India","SBIN.NS","83850921169","9.39546","India"
"235","Sberbank","SBER.ME","83822862280","3.87","Russia"
"236","DoorDash","DASH","83816366080","197.8","United States"
"237","Mondelez International","MDLZ","83049750528","64.14","United States"
"238","Thomson Reuters","TRI","83005079552","184.26","Canada"
"239","Apollo Global Management","APO","82906644480","145.07","United States"
"240","Munich RE (Münchener Rück)","MUV2.DE","82624259343","628.771","Germany"
"241","Midea","000333.SZ","81691390279","10.7052","China"
"242","3M","MMM","81125408768","150.74","United States"
"243","The Cigna Group","CI","80647806976","301.89","United States"
"244","Rheinmetall","RHM.F","80416365961","1802.12","Germany"
"245","Fortinet","FTNT","80406953984","105.05","United States"
"246","London Stock Exchange","LSEG.L","79835270115","15076.7","United Kingdom"
"247","Synopsys","SNPS","79739084800","515.71","United States"
"248","TransDigm Group","TDG","79523627008","1415.84","United States"
"249","BP","BP","79522013184","30.56","United Kingdom"
"250","Atlas Copco","ATCO-B.ST","79223535566","14.8205","Sweden"
"251","Vinci","DG.PA","78922128195","140.14","France"
"252","Tokio Marine","8766.T","77920306406","40.5246","Japan"
"253","SoftBank","9984.T","77822114282","54.1334","Japan"
"254","Mitsubishi Corporation","8058.T","77680336328","19.5356","Japan"
"255","Capital One","COF","77026058240","201.04","United States"
"256","Aon","AON","76673818624","355.07","United Kingdom"
"257","CVS Health","CVS","76533710848","60.5","United States"
"258","Infosys","INFY","76508585984","18.38","India"
"259","Tokyo Electron","8035.T","76083662949","166.082","Japan"
"260","GlaxoSmithKline","GSK","75547656192","36.35","United Kingdom"
"261","Petrobras","PBR","75410874368","12.19","Brazil"
"262","CSL","CSL.AX","75273807066","155.456","Australia"
"263","O'Reilly Automotive","ORLY","75271733248","1320.8","United States"
"264","Dell","DELL","75262156800","107.85","United States"
"265","Constellation Software","CSU.TO","75194246758","3548.32","Canada"
"266","Marriott International","MAR","75085856768","274.14","United States"
"267","Southern Copper","SCCO","75011497984","93.29","United States"
"268","Foxconn (Hon Hai Precision Industry)","2317.TW","74882848720","5.39164","Taiwan"
"269","Republic Services","RSG","74371162112","237.99","United States"
"270","Bank of Communications","601328.SS","74341824380","1.07204","China"
"271","Bank of Montreal","BMO","74118987776","101.87","Canada"
"272","General Dynamics","GD","73277472768","273.02","United States"
"273","Illinois Tool Works","ITW","73089212416","249.14","United States"
"274","Canadian Pacific Railway","CP","73068707840","78.53","Canada"
"275","Wuliangye Yibin","000858.SZ","72908203904","18.783","China"
"276","Itōchū Shōji","8001.T","72608981629","51.2128","Japan"
"277","Workday","WDAY","72225488896","270.02","United States"
"278","Postal Savings Bank of China","601658.SS","71767749002","0.74432","China"
"279","MediaTek","2454.TW","71700949322","44.9854","Taiwan"
"280","National Australia Bank","NAB.AX","71489753277","23.4017","Australia"
"281","Zoetis","ZTS","71415816192","160.41","United States"
"282","Ecolab","ECL","71303520256","251.5","United States"
"283","Colgate-Palmolive","CL","71219707904","87.88","United States"
"284","Williams Companies","WMB","70904053760","58.07","United States"
"285","KDDI","9433.T","70392387346","17.688","Japan"
"286","PayPal","PYPL","70304407552","72.29","United States"
"287","PNC Financial Services","PNC","70225010688","177.53","United States"
"288","Westpac Banking","WBC.AX","69271027753","20.2642","Australia"
"289","U.S. Bancorp","USB","69129789440","44.37","United States"
"290","Bank Central Asia","BBCA.JK","69106456989","0.560592","Indonesia"
"291","Motorola Solutions","MSI","68983046144","413.28","United States"
"292","Enterprise Products","EPD","68884267008","31.76","United States"
"293","Emerson","EMR","68338118656","121.49","United States"
"294","Chipotle Mexican Grill","CMG","68243787776","50.65","United States"
"295","ADNOC Gas","ADNOCGAS.AE","68125964402","0.89","United Arab Emirates"
"296","Northrop Grumman","NOC","67742593024","470.67","United States"
"297","Canadian Natural Resources","CNQ","67466412032","32.23","Canada"
"298","NetEase","NTES","67372269568","106.4","China"
"299","Royal Caribbean Group","RCL","67287138304","247.78","United States"
"300","BAE Systems","BA.L","67134695858","2267.18","United Kingdom"
"301","National Grid","NGG","66719031296","67.53","United Kingdom"
"302","Cement Roadstone Holding","CRH","66281365504","98.16","Ireland"
"303","Siemens Energy","ENR.F","66157357299","83.1607","Germany"
"304","Bajaj Finance","BAJFINANCE.NS","66155908947","106.557","India"
"305","Industrial Bank","601166.SS","66149351144","3.18419","China"
"306","Canadian National Railway","CNI","66012999680","105.2","Canada"
"307","Itaú Unibanco","ITUB","65626906624","6.62","Brazil"
"308","Coinbase","COIN","65433710592","256.9","United States"
"309","Mizuho Financial Group","MFG","64869543936","5.17","Japan"
"310","Holcim Group","HOLN.SW","64854174808","117.699","Switzerland"
"311","Hindustan Unilever","HINDUNILVR.NS","64817609413","27.5809","India"
"312","Zijin Mining","601899.SS","64740721204","2.4857","China"
"313","Diageo","DEO","64281755648","112.27","United Kingdom"
"314","Carrier Global","CARR","63998193664","74.65","United States"
"315","Equinor","EQNR","63957663744","23.63","Norway"
"316","Howmet Aerospace","HWM","63901593600","158.3","United States"
"317","EOG Resources","EOG","63666057216","116.65","United States"
"318","Autodesk","ADSK","63543803904","297.01","United States"
"319","Nu Holdings","NU","63317192704","13.14","Brazil"
"320","Johnson Controls","JCI","63211991040","96.06","Ireland"
"321","ING","ING","63187259392","20.79","Netherlands"
"322","Scotiabank","BNS","63111000064","50.67","Canada"
"323","ITC","ITC.NS","63009559593","5.03508","India"
"324","BNY Mellon (Bank of New York Mellon)","BK","62908108800","87.93","United States"
"325","Shin-Etsu Chemical","4063.T","62212111417","31.7423","Japan"
"326","Roper Technologies","ROP","62043680768","577.07","United States"
"327","Regeneron Pharmaceuticals","REGN","61989183488","574.16","United States"
"328","Siemens Healthineers","SHL.DE","61822148870","55.1216","Germany"
"329","Merck KGaA","MRK.DE","61786043764","142.109","Germany"
"330","Energy Transfer Partners","ET","61772042240","18","United States"
"331","Hong Kong Exchanges & Clearing","0388.HK","61721457948","48.8365","Hong Kong"
"332","Mitsubishi Heavy Industries","7011.T","61644747993","18.3598","Japan"
"333","Kinder Morgan","KMI","61126172672","27.5","United States"
"334","Life Insurance Corporation of India (LIC)","LICI.NS","61021958598","9.64774","India"
"335","AutoZone","AZO","60971929600","3644.75","United States"
"336","CIBC","CM","60922953728","64.81","Canada"
"337","Air Products and Chemicals","APD","60896944128","273.64","United States"
"338","Hilton Worldwide","HLT","60853579776","256.01","United States"
"339","Simon Property Group","SPG","60674125824","160.88","United States"
"340","Barclays","BCS","60536152064","17","United Kingdom"
"341","Snowflake","SNOW","60478783488","181.02","United States"
"342","Copart","CPRT","60274540544","62.39","United States"
"343","Atlassian","TEAM","60250378240","229.52","Australia"
"344","The Travelers Companies","TRV","60022661120","264.92","United States"
"345","Wesfarmers","WES.AX","59781128231","52.6701","Australia"
"346","Rosneft","ROSN.ME","59710461962","5.66","Russia"
"347","Adyen","ADYEN.AS","59251922701","1881.36","Netherlands"
"348","Volkswagen","VOW3.DE","59211566682","116.839","Germany"
"349","CaixaBank","CABK.MC","59099687420","8.34984","Spain"
"350","Volvo Group","VOLV-A.ST","58986058404","29.0403","Sweden"
"351","Generali","G.MI","58879331472","38.9689","Italy"
"352","Monster Beverage","MNST","58732859392","60.23","United States"
"353","Lloyds Banking Group","LYG","58614419456","3.91","United Kingdom"
"354","Lukoil","LKOH.ME","58532830797","84.11","Russia"
"355","Crédit Agricole","ACA.PA","58497666709","19.3381","France"
"356","Compass Group","CPG.L","58377991644","3439.81","United Kingdom"
"357","Deutsche Börse","DB1.DE","58314969617","317.312","Germany"
"358","Mercedes-Benz","MBG.DE","58268481585","60.5133","Germany"
"359","ACWA POWER Company","2082.SR","58134836188","79.4006","Saudi Arabia"
"360","Saudi Telecom Company","7010.SR","57839019063","11.5981","Saudi Arabia"
"361","BMW","BMW.DE","57753438631","93.2688","Germany"
"362","Charter Communications","CHTR","57707851776","411.13","United States"
"363","Compagnie de Saint-Gobain","SGO.PA","57691551409","116.108","France"
"364","Larsen &amp; Toubro","LT.NS","57661319987","41.927","India"
"365","Mitsui Bussan","8031.T","57606552864","20.0429","Japan"
"366","CSX Corporation","CSX","57370918912","30.54","United States"
"367","Grayscale Bitcoin Trust","GBTC","57279770624","82.73","United States"
"368","Digital Realty","DLR","56892776448","165.8","United States"
"369","Aflac","AFL","56783941632","105.03","United States"
"370","The Saudi National Bank","1180.SR","56764942279","9.54514","Saudi Arabia"
"371","Thales","HO.PA","56738452229","269.923","France"
"372","Freeport-McMoRan","FCX","56686813184","39.47","United States"
"373","Walmex","WMMVF","56684478464","3.2","Mexico"
"374","Marvell Technology","MRVL","56563654656","65.48","United States"
"375","SMIC","0981.HK","56424500489","5.47327","China"
"376","Axon Enterprise","AXON","56422039552","724.77","United States"
"377","Ares Management","ARES","56334700544","172.5","United States"
"378","OCBC Bank","O39.SI","56146564300","12.4806","Singapore"
"379","Nongfu Spring","9633.HK","56077169896","4.98619","China"
"380","Newmont","NEM","55727906816","50.07","United States"
"381","CITIC Bank","601998.SS","55680486603","1.06232","China"
"382","FedEx","FDX","55383310336","231.15","United States"
"383","Robinhood","HOOD","55216082944","62.57","United States"
"384","Danone","BN.PA","55107382981","80.6619","France"
"385","ANZ Bank","ANZ.AX","54880054017","18.4945","Australia"
"386","Universal Music Group","UMG.AS","54784202864","29.9415","Netherlands"
"387","MetLife","MET","54482546688","81.16","United States"
"388","Paychex","PAYX","54482489344","151.26","United States"
"389","Manulife Financial","MFC","54378541056","31.75","Canada"
"390","DSV","DSV.VI","54312337578","230.639","Denmark"
"391","Norfolk Southern","NSC","54165172224","240.26","United States"
"392","Truist Financial","TFC","54149476352","41.35","United States"
"393","Cencora","COR","54076620800","279","United States"
"394","Oneok","OKE","54036914176","86.51","United States"
"395","3i Group","III.L","53970460109","5551.48","United Kingdom"
"396","Foxconn Industrial Internet","601138.SS","53913443582","2.71483","China"
"397","Agnico Eagle Mines","AEM","53872893952","107","Canada"
"398","Deutsche Bank","DB","53783699456","27.51","Germany"
"399","NXP Semiconductors","NXPI","53658394624","212.4","Netherlands"
"400","Allstate","ALL","53641531392","202.56","United States"
"401","Japan Tobacco","2914.T","53196364936","29.9598","Japan"
"402","American Electric Power","AEP","53184454656","99.56","United States"
"403","Public Storage","PSA","53002973184","302.13","United States"
"404","NatWest Group","NWG","52925423616","13.12","United Kingdom"
"405","Macquarie","MQG.AX","52895349221","137.331","Australia"
"406","CITIC Securities","600030.SS","52829954545","3.7591","China"
"407","LG Energy Solution","373220.KS","52603311815","224.8","South Korea"
"408","Vistra","VST","52596461568","155","United States"
"409","America Movil","AMX","52298403840","17.24","Mexico"
"410","Roblox","RBLX","52241432576","77.02","United States"
"411","Cloudflare","NET","52116279296","150.36","United States"
"412","Swiss Re","SREN.SW","52062473728","177.04","Switzerland"
"413","HCL Technologies","HCLTECH.NS","52056768503","19.2169","India"
"414","FICO","FICO","51994603520","2136.03","United States"
"415","Cheniere Energy","LNG","51613802496","232.72","United States"
"416","Ma'aden","1211.SR","51602654295","13.5978","Saudi Arabia"
"417","MPLX","MPLX","51489148928","50.44","United States"
"418","Discover Financial Services","DFS","51354828800","204.07","United States"
"419","Samsung Biologics","207940.KS","51291704899","720.652","South Korea"
"420","W. W. Grainger","GWW","51227561984","1066.37","United States"
"421","Phillips 66","PSX","51161862144","125.57","United States"
"422","Paccar","PCAR","51034263552","96.26","United States"
"423","Jingdong Mall","JD","50993758208","37.25","China"
"424","DHL Group (Deutsche Post)","DHL.DE","50949892265","44.1805","Germany"
"425","Quanta Services","PWR","50918211584","343.58","United States"
"426","Infineon","IFX.DE","50628528699","38.9633","Germany"
"427","TC Energy","TRP","50494828544","48.57","Canada"
"428","Becton Dickinson","BDX","50253672448","175.34","United States"
"429","Marathon Petroleum","MPC","50026729472","162.84","United States"`;

    const data = processCSVData(csvContent);
    // Mark top 50 entries
    data.forEach((d, i) => d.top50 = i < 50);

    const margin = {top: 30, right: 30, bottom: 30, left: 30};
    const width = 1000, height = 800;
    const svg = d3.select("#chart").append("svg")
      .attr("width", width)
      .attr("height", height)
      .attr("viewBox", [0, 0, width, height]);
    const vizGroup = svg.append("g").attr("transform", `translate(${margin.left}, ${margin.top})`);

    const regionCenters = {
      "UK": { x: (width - margin.left - margin.right) * 0.25, y: (height - margin.top - margin.bottom) * 0.25 },
      "USA": { x: (width - margin.left - margin.right) * 0.75, y: (height - margin.top - margin.bottom) * 0.25 },
      "EU": { x: (width - margin.left - margin.right) * 0.25, y: (height - margin.top - margin.bottom) * 0.75 },
      "RoW": { x: (width - margin.left - margin.right) * 0.75, y: (height - margin.top - margin.bottom) * 0.75 }
    };
    const regionSize = { width: 440, height: 340 };
    Object.entries(regionCenters).forEach(([region, center]) => {
      vizGroup.append("rect")
        .attr("class", "region-background")
        .attr("x", center.x - regionSize.width/2)
        .attr("y", center.y - regionSize.height/2)
        .attr("width", regionSize.width)
        .attr("height", regionSize.height);
    });

    const colorMap = {
      "UK": "#d8bfd8",
      "USA": "#add8e6",
      "EU": "#98fb98",
      "RoW": "#ffdab9"
    };


    const tooltip = d3.select("body").append("div")
      .attr("class", "tooltip")
      .style("opacity", 0);

    const radius = d3.scaleSqrt()
      .domain([0, d3.max(data, d => d.marketCap)])
      .range([2, 40]);

    const simulation = d3.forceSimulation(data)
      .force("x", d3.forceX().x(d => regionCenters[d.region].x).strength(0.3))
      .force("y", d3.forceY().y(d => regionCenters[d.region].y).strength(0.3))
      .force("collide", d3.forceCollide().radius(d => radius(d.marketCap) + 2))
      .force("charge", d3.forceManyBody().strength(-15));

    const node = vizGroup.append("g").selectAll("circle").data(data).join("circle")
      .attr("r", d => radius(d.marketCap))
      .attr("fill", d => d.top50 ? d3.color(colorMap[d.region]).darker(0.7) : colorMap[d.region])
      .attr("stroke", "white")
      .attr("stroke-width", 1.5)
      .attr("opacity", 0.85)
      .on("mouseover", function(event, d) {
        d3.select(this).attr("stroke", "#333").attr("stroke-width", 2).attr("opacity", 1);
        tooltip.transition().duration(200).style("opacity", 0.9);
        tooltip.html(`<strong>${d.name} (${d.ticker})</strong><br>` +
          `Market Cap: $${d.marketCap.toFixed(1)}B<br>` +
          `Country: ${d.country}<br>` +
          `Region: ${d.region}`)
          .style("left", (event.pageX + 10) + "px")
          .style("top", (event.pageY - 28) + "px");
      })
      .on("mouseout", function() {
        d3.select(this).attr("stroke", "white").attr("stroke-width", 1.5).attr("opacity", 0.85);
        tooltip.transition().duration(500).style("opacity", 0);
      });

    const labels = vizGroup.append("g").selectAll("text").data(data.slice(0, 50)).join("text")
      .attr("font-size", "12px")
      .attr("text-anchor", "middle")
      .attr("pointer-events", "none")
      .attr("dy", d => -radius(d.marketCap) - 5)
      .text(d => d.ticker)
      .attr("fill", "black")
      .attr("font-weight", "bold");

    Object.entries(regionCenters).forEach(([region, center]) => {
      vizGroup.append("text")
        .attr("class", "region-label")
        .attr("x", center.x)
        .attr("y", center.y - regionSize.height/2 - 15)
        .text(region);
    });

    simulation.on("tick", () => {
      data.forEach(d => {
        const region = regionCenters[d.region];
        const r = radius(d.marketCap);
        const maxX = region.x + regionSize.width/2 - r;
        const minX = region.x - regionSize.width/2 + r;
        const maxY = region.y + regionSize.height/2 - r;
        const minY = region.y - regionSize.height/2 + r;
        d.x = Math.max(minX, Math.min(maxX, d.x));
        d.y = Math.max(minY, Math.min(maxY, d.y));
      });
      node.attr("cx", d => d.x).attr("cy", d => d.y);
      labels.attr("x", d => d.x).attr("y", d => d.y);
    });
  </script>
  
  <br />
  <h2>Embed this chart</h2>
<pre><code id="embed-code">&lt;iframe src="https://ersatzben.github.io/top2000/bubble.html" width="100%" height="600" frameborder="0"&gt;&lt;/iframe&gt;</code></pre>
<button onclick="copyEmbedCode()">Copy embed code</button>

<script>
  function copyEmbedCode() {
    const code = document.getElementById("embed-code").textContent;
    navigator.clipboard.writeText(code).then(() => {
      alert("Embed code copied to clipboard");
    });
  }
</script>

</body>
</html>
